<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WebFrame++: coroute::SessionMiddleware Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WebFrame++<span id="projectnumber">&#160;v2.0.0</span>
   </div>
   <div id="projectbrief">Modern C++20 Coroutine-based Web Framework with HTTP/2, TLS, and WebSocket support</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../de/d6f/namespacecoroute.html">coroute</a></li><li class="navelem"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html">SessionMiddleware</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle"><div class="title">coroute::SessionMiddleware Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d4/d5e/session_8hpp_source.html">session.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa90e471c8c33240d5468335c4077b8b1" id="r_aa90e471c8c33240d5468335c4077b8b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#aa90e471c8c33240d5468335c4077b8b1">SessionMiddleware</a> (std::shared_ptr&lt; <a class="el" href="../../d1/dc0/classcoroute_1_1_session_store.html">SessionStore</a> &gt; <a class="el" href="../../df/d44/classcoroute_1_1_task.html">store</a>, <a class="el" href="../../db/d73/structcoroute_1_1_session_options.html">SessionOptions</a> options={})</td></tr>
<tr class="separator:aa90e471c8c33240d5468335c4077b8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8489d59cc8696afaacedd808f8e5f1" id="r_a8e8489d59cc8696afaacedd808f8e5f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">Task</a>&lt; <a class="el" href="../../d3/df8/classcoroute_1_1_response.html">Response</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a8e8489d59cc8696afaacedd808f8e5f1">operator()</a> (<a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;<a class="el" href="../../df/d44/classcoroute_1_1_task.html">req</a>, <a class="el" href="../../de/d6f/namespacecoroute.html#a9e5bc2d098a922953cf99888180be209">Next</a> <a class="el" href="../../df/d44/classcoroute_1_1_task.html">next</a>)</td></tr>
<tr class="separator:a8e8489d59cc8696afaacedd808f8e5f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6638f52def3d501d93d2a517d70b8ed1" id="r_a6638f52def3d501d93d2a517d70b8ed1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a6638f52def3d501d93d2a517d70b8ed1">destroy_session</a> (<a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;<a class="el" href="../../df/d44/classcoroute_1_1_task.html">req</a>, <a class="el" href="../../d3/df8/classcoroute_1_1_response.html">Response</a> &amp;<a class="el" href="../../df/d44/classcoroute_1_1_task.html">resp</a>)</td></tr>
<tr class="separator:a6638f52def3d501d93d2a517d70b8ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:acc67da39610dd4ddb902fa10bd847bc6" id="r_acc67da39610dd4ddb902fa10bd847bc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">static</a> std::shared_ptr&lt; <a class="el" href="../../d9/d08/classcoroute_1_1_session.html">Session</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acc67da39610dd4ddb902fa10bd847bc6">get_session</a> (<a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;<a class="el" href="../../df/d44/classcoroute_1_1_task.html">req</a>)</td></tr>
<tr class="separator:acc67da39610dd4ddb902fa10bd847bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af80d60275e1659a681bccbaf7371bc8c" id="r_af80d60275e1659a681bccbaf7371bc8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d42/structcoroute_1_1_cookie.html">Cookie</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#af80d60275e1659a681bccbaf7371bc8c">create_session_cookie</a> (<a class="el" href="../../df/d44/classcoroute_1_1_task.html">const</a> std::string &amp;<a class="el" href="../../df/d44/classcoroute_1_1_task.html">session_id</a>)</td></tr>
<tr class="separator:af80d60275e1659a681bccbaf7371bc8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0ff4140b2e8baf7065ad4033b4c3a282" id="r_a0ff4140b2e8baf7065ad4033b4c3a282"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d1/dc0/classcoroute_1_1_session_store.html">SessionStore</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a></td></tr>
<tr class="separator:a0ff4140b2e8baf7065ad4033b4c3a282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbdb8ea97a7719da982f47a9f35fcf64" id="r_acbdb8ea97a7719da982f47a9f35fcf64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d73/structcoroute_1_1_session_options.html">SessionOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a></td></tr>
<tr class="separator:acbdb8ea97a7719da982f47a9f35fcf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d4/d5e/session_8hpp_source.html#l00183">183</a> of file <a class="el" href="../../d4/d5e/session_8hpp_source.html">session.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa90e471c8c33240d5468335c4077b8b1" name="aa90e471c8c33240d5468335c4077b8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90e471c8c33240d5468335c4077b8b1">&#9670;&#160;</a></span>SessionMiddleware()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">coroute::SessionMiddleware::SessionMiddleware </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../d1/dc0/classcoroute_1_1_session_store.html">SessionStore</a> &gt;&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d73/structcoroute_1_1_session_options.html">SessionOptions</a>&#160;</td>
          <td class="paramname"><em>options</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d1a/session_8cpp_source.html#l00130">130</a> of file <a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>    : <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a>(std::move(store))</div>
<div class="line"><span class="lineno">  132</span>    , <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>(std::move(options))</div>
<div class="line"><span class="lineno">  133</span>{}</div>
<div class="ttc" id="aclasscoroute_1_1_session_middleware_html_a0ff4140b2e8baf7065ad4033b4c3a282"><div class="ttname"><a href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">coroute::SessionMiddleware::store_</a></div><div class="ttdeci">std::shared_ptr&lt; SessionStore &gt; store_</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00184">session.hpp:184</a></div></div>
<div class="ttc" id="aclasscoroute_1_1_session_middleware_html_acbdb8ea97a7719da982f47a9f35fcf64"><div class="ttname"><a href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">coroute::SessionMiddleware::options_</a></div><div class="ttdeci">SessionOptions options_</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00185">session.hpp:185</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af80d60275e1659a681bccbaf7371bc8c" name="af80d60275e1659a681bccbaf7371bc8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af80d60275e1659a681bccbaf7371bc8c">&#9670;&#160;</a></span>create_session_cookie()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d42/structcoroute_1_1_cookie.html">Cookie</a> coroute::SessionMiddleware::create_session_cookie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">const</a> std::string &amp;&#160;</td>
          <td class="paramname"><em>session_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d1a/session_8cpp_source.html#l00135">135</a> of file <a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  135</span>                                                                           {</div>
<div class="line"><span class="lineno">  136</span>    Cookie c;</div>
<div class="line"><span class="lineno">  137</span>    c.name = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#ac5f5446210f06f4906c30f38bf4c5f2d">cookie_name</a>;</div>
<div class="line"><span class="lineno">  138</span>    c.value = session_id;</div>
<div class="line"><span class="lineno">  139</span>    c.path = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#a6f89bfd1480d122ce7608f97abcf16d9">cookie_path</a>;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#af8ec7cf2f2090713602b701534cce12c">cookie_domain</a>.empty()) {</div>
<div class="line"><span class="lineno">  141</span>        c.domain = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#af8ec7cf2f2090713602b701534cce12c">cookie_domain</a>;</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span>    c.max_age = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#a6199893379f3728b3d326cb4fe9cd98f">max_age</a>;</div>
<div class="line"><span class="lineno">  144</span>    c.secure = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#adc513e7227d0b2110dd885c009ebdf12">secure</a>;</div>
<div class="line"><span class="lineno">  145</span>    c.http_only = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#ade978bbd2f91412ee7b5c479c276c12f">http_only</a>;</div>
<div class="line"><span class="lineno">  146</span>    c.same_site = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#afdb30d687409201c55e8ff34d80cdeeb">same_site</a>;</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">return</span> c;</div>
<div class="line"><span class="lineno">  148</span>}</div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_a6199893379f3728b3d326cb4fe9cd98f"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#a6199893379f3728b3d326cb4fe9cd98f">coroute::SessionOptions::max_age</a></div><div class="ttdeci">std::chrono::seconds max_age</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00165">session.hpp:165</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_a6f89bfd1480d122ce7608f97abcf16d9"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#a6f89bfd1480d122ce7608f97abcf16d9">coroute::SessionOptions::cookie_path</a></div><div class="ttdeci">std::string cookie_path</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00159">session.hpp:159</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_ac5f5446210f06f4906c30f38bf4c5f2d"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#ac5f5446210f06f4906c30f38bf4c5f2d">coroute::SessionOptions::cookie_name</a></div><div class="ttdeci">std::string cookie_name</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00156">session.hpp:156</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_adc513e7227d0b2110dd885c009ebdf12"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#adc513e7227d0b2110dd885c009ebdf12">coroute::SessionOptions::secure</a></div><div class="ttdeci">bool secure</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00168">session.hpp:168</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_ade978bbd2f91412ee7b5c479c276c12f"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#ade978bbd2f91412ee7b5c479c276c12f">coroute::SessionOptions::http_only</a></div><div class="ttdeci">bool http_only</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00169">session.hpp:169</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_af8ec7cf2f2090713602b701534cce12c"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#af8ec7cf2f2090713602b701534cce12c">coroute::SessionOptions::cookie_domain</a></div><div class="ttdeci">std::string cookie_domain</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00162">session.hpp:162</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_afdb30d687409201c55e8ff34d80cdeeb"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#afdb30d687409201c55e8ff34d80cdeeb">coroute::SessionOptions::same_site</a></div><div class="ttdeci">SameSite same_site</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00170">session.hpp:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6638f52def3d501d93d2a517d70b8ed1" name="a6638f52def3d501d93d2a517d70b8ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6638f52def3d501d93d2a517d70b8ed1">&#9670;&#160;</a></span>destroy_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">void</a> coroute::SessionMiddleware::destroy_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/df8/classcoroute_1_1_response.html">Response</a> &amp;&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d1a/session_8cpp_source.html#l00194">194</a> of file <a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span>                                                                    {</div>
<div class="line"><span class="lineno">  195</span>    <span class="keyword">auto</span> sess = <a class="code hl_function" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acc67da39610dd4ddb902fa10bd847bc6">get_session</a>(req);</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span> (sess) {</div>
<div class="line"><span class="lineno">  197</span>        <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a>-&gt;destroy(sess-&gt;id());</div>
<div class="line"><span class="lineno">  198</span>        <a class="code hl_function" href="../../de/d6f/namespacecoroute.html#a0bf46a6c1b3367cfb39baf49840e96d0">delete_cookie</a>(resp, <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#ac5f5446210f06f4906c30f38bf4c5f2d">cookie_name</a>, <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#a6f89bfd1480d122ce7608f97abcf16d9">cookie_path</a>, <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#af8ec7cf2f2090713602b701534cce12c">cookie_domain</a>);</div>
<div class="line"><span class="lineno">  199</span>    }</div>
<div class="line"><span class="lineno">  200</span>}</div>
<div class="ttc" id="aclasscoroute_1_1_session_middleware_html_acc67da39610dd4ddb902fa10bd847bc6"><div class="ttname"><a href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acc67da39610dd4ddb902fa10bd847bc6">coroute::SessionMiddleware::get_session</a></div><div class="ttdeci">static std::shared_ptr&lt; Session &gt; get_session(Request &amp;req)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d1a/session_8cpp_source.html#l00189">session.cpp:189</a></div></div>
<div class="ttc" id="anamespacecoroute_html_a0bf46a6c1b3367cfb39baf49840e96d0"><div class="ttname"><a href="../../de/d6f/namespacecoroute.html#a0bf46a6c1b3367cfb39baf49840e96d0">coroute::delete_cookie</a></div><div class="ttdeci">void delete_cookie(Response &amp;resp, std::string_view name, std::string_view path=&quot;/&quot;, std::string_view domain=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de8/cookie_8cpp_source.html#l00172">cookie.cpp:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc67da39610dd4ddb902fa10bd847bc6" name="acc67da39610dd4ddb902fa10bd847bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc67da39610dd4ddb902fa10bd847bc6">&#9670;&#160;</a></span>get_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="../../d9/d08/classcoroute_1_1_session.html">Session</a> &gt; coroute::SessionMiddleware::get_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d1a/session_8cpp_source.html#l00189">189</a> of file <a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>                                                                  {</div>
<div class="line"><span class="lineno">  190</span>    <span class="keyword">auto</span> ctx = req.get_context&lt;std::shared_ptr&lt;Session&gt;&gt;(<a class="code hl_variable" href="../../de/d6f/namespacecoroute.html#ad4199152a4f2ac3576dad620291b90e5">SESSION_KEY</a>);</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">return</span> ctx.value_or(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  192</span>}</div>
<div class="ttc" id="anamespacecoroute_html_ad4199152a4f2ac3576dad620291b90e5"><div class="ttname"><a href="../../de/d6f/namespacecoroute.html#ad4199152a4f2ac3576dad620291b90e5">coroute::SESSION_KEY</a></div><div class="ttdeci">static const std::string SESSION_KEY</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d1a/session_8cpp_source.html#l00128">session.cpp:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e8489d59cc8696afaacedd808f8e5f1" name="a8e8489d59cc8696afaacedd808f8e5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8489d59cc8696afaacedd808f8e5f1">&#9670;&#160;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d44/classcoroute_1_1_task.html">Task</a>&lt; <a class="el" href="../../d3/df8/classcoroute_1_1_response.html">Response</a> &gt; coroute::SessionMiddleware::operator() </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd1/classcoroute_1_1_request.html">Request</a> &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d6f/namespacecoroute.html#a9e5bc2d098a922953cf99888180be209">Next</a>&#160;</td>
          <td class="paramname"><em>next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d1a/session_8cpp_source.html#l00150">150</a> of file <a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  150</span>                                                                    {</div>
<div class="line"><span class="lineno">  151</span>    <span class="comment">// Get session ID from cookie</span></div>
<div class="line"><span class="lineno">  152</span>    <span class="keyword">auto</span> jar = <a class="code hl_function" href="../../de/d6f/namespacecoroute.html#aa19f89c6938734c178b96539a6ea0e57">cookies</a>(req);</div>
<div class="line"><span class="lineno">  153</span>    <span class="keyword">auto</span> session_id = jar.get(<a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#ac5f5446210f06f4906c30f38bf4c5f2d">cookie_name</a>);</div>
<div class="line"><span class="lineno">  154</span>    </div>
<div class="line"><span class="lineno">  155</span>    std::shared_ptr&lt;Session&gt; sess;</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordtype">bool</span> need_set_cookie = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  157</span>    </div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordflow">if</span> (session_id) {</div>
<div class="line"><span class="lineno">  159</span>        <span class="comment">// Try to load existing session</span></div>
<div class="line"><span class="lineno">  160</span>        sess = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a>-&gt;load(std::string(*session_id));</div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="line"><span class="lineno">  162</span>    </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">if</span> (!sess) {</div>
<div class="line"><span class="lineno">  164</span>        <span class="comment">// Create new session</span></div>
<div class="line"><span class="lineno">  165</span>        <span class="keyword">auto</span> new_id = <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a>-&gt;generate_id();</div>
<div class="line"><span class="lineno">  166</span>        sess = std::make_shared&lt;Session&gt;(new_id, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  167</span>        need_set_cookie = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  168</span>    }</div>
<div class="line"><span class="lineno">  169</span>    </div>
<div class="line"><span class="lineno">  170</span>    <span class="comment">// Store session in request context</span></div>
<div class="line"><span class="lineno">  171</span>    req.set_context(<a class="code hl_variable" href="../../de/d6f/namespacecoroute.html#ad4199152a4f2ac3576dad620291b90e5">SESSION_KEY</a>, sess);</div>
<div class="line"><span class="lineno">  172</span>    </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// Call next handler</span></div>
<div class="line"><span class="lineno">  174</span>    Response resp = <span class="keyword">co_await</span> next(req);</div>
<div class="line"><span class="lineno">  175</span>    </div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">// Auto-save if modified</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#a29cb28b87c9e64d04575d0386cdf8f19">auto_save</a> &amp;&amp; sess-&gt;is_modified()) {</div>
<div class="line"><span class="lineno">  178</span>        <a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#a0ff4140b2e8baf7065ad4033b4c3a282">store_</a>-&gt;save(*sess);</div>
<div class="line"><span class="lineno">  179</span>    }</div>
<div class="line"><span class="lineno">  180</span>    </div>
<div class="line"><span class="lineno">  181</span>    <span class="comment">// Set cookie if new session or rolling</span></div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span> (need_set_cookie || (<a class="code hl_variable" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#acbdb8ea97a7719da982f47a9f35fcf64">options_</a>.<a class="code hl_variable" href="../../db/d73/structcoroute_1_1_session_options.html#a61c05f36bfd2ca42851b77a17ae0e2fa">rolling</a> &amp;&amp; !sess-&gt;is_new())) {</div>
<div class="line"><span class="lineno">  183</span>        <a class="code hl_function" href="../../de/d6f/namespacecoroute.html#ad59a901a5c775604bc547840790e2267">set_cookie</a>(resp, <a class="code hl_function" href="../../d1/d8b/classcoroute_1_1_session_middleware.html#af80d60275e1659a681bccbaf7371bc8c">create_session_cookie</a>(sess-&gt;id()));</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span>    </div>
<div class="line"><span class="lineno">  186</span>    <span class="keyword">co_return</span> resp;</div>
<div class="line"><span class="lineno">  187</span>}</div>
<div class="ttc" id="aclasscoroute_1_1_session_middleware_html_af80d60275e1659a681bccbaf7371bc8c"><div class="ttname"><a href="../../d1/d8b/classcoroute_1_1_session_middleware.html#af80d60275e1659a681bccbaf7371bc8c">coroute::SessionMiddleware::create_session_cookie</a></div><div class="ttdeci">Cookie create_session_cookie(const std::string &amp;session_id)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d1a/session_8cpp_source.html#l00135">session.cpp:135</a></div></div>
<div class="ttc" id="anamespacecoroute_html_aa19f89c6938734c178b96539a6ea0e57"><div class="ttname"><a href="../../de/d6f/namespacecoroute.html#aa19f89c6938734c178b96539a6ea0e57">coroute::cookies</a></div><div class="ttdeci">CookieJar cookies(const Request &amp;req)</div><div class="ttdef"><b>Definition</b> <a href="../../da/def/cookie_8hpp_source.html#l00111">cookie.hpp:111</a></div></div>
<div class="ttc" id="anamespacecoroute_html_ad59a901a5c775604bc547840790e2267"><div class="ttname"><a href="../../de/d6f/namespacecoroute.html#ad59a901a5c775604bc547840790e2267">coroute::set_cookie</a></div><div class="ttdeci">void set_cookie(Response &amp;resp, const Cookie &amp;cookie)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de8/cookie_8cpp_source.html#l00162">cookie.cpp:162</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_a29cb28b87c9e64d04575d0386cdf8f19"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#a29cb28b87c9e64d04575d0386cdf8f19">coroute::SessionOptions::auto_save</a></div><div class="ttdeci">bool auto_save</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00173">session.hpp:173</a></div></div>
<div class="ttc" id="astructcoroute_1_1_session_options_html_a61c05f36bfd2ca42851b77a17ae0e2fa"><div class="ttname"><a href="../../db/d73/structcoroute_1_1_session_options.html#a61c05f36bfd2ca42851b77a17ae0e2fa">coroute::SessionOptions::rolling</a></div><div class="ttdeci">bool rolling</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5e/session_8hpp_source.html#l00176">session.hpp:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="acbdb8ea97a7719da982f47a9f35fcf64" name="acbdb8ea97a7719da982f47a9f35fcf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbdb8ea97a7719da982f47a9f35fcf64">&#9670;&#160;</a></span>options_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d73/structcoroute_1_1_session_options.html">SessionOptions</a> coroute::SessionMiddleware::options_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d5e/session_8hpp_source.html#l00185">185</a> of file <a class="el" href="../../d4/d5e/session_8hpp_source.html">session.hpp</a>.</p>

</div>
</div>
<a id="a0ff4140b2e8baf7065ad4033b4c3a282" name="a0ff4140b2e8baf7065ad4033b4c3a282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff4140b2e8baf7065ad4033b4c3a282">&#9670;&#160;</a></span>store_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../d1/dc0/classcoroute_1_1_session_store.html">SessionStore</a>&gt; coroute::SessionMiddleware::store_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d5e/session_8hpp_source.html#l00184">184</a> of file <a class="el" href="../../d4/d5e/session_8hpp_source.html">session.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/coroute/core/<a class="el" href="../../d4/d5e/session_8hpp_source.html">session.hpp</a></li>
<li>src/core/<a class="el" href="../../d9/d1a/session_8cpp_source.html">session.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
